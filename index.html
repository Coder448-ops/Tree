<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My VolumeShade Clone</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
        canvas { display: block; }
    </style>
</head>
<body>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "tweakpane": "https://cdn.jsdelivr.net/npm/tweakpane@4.0.3/dist/tweakpane.min.js"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { Pane } from 'tweakpane';

        // 1. Sahna va Kamera
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 3;

        // 2. Renderer (Sifatni oshirish uchun antialias)
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        // 3. 3D Ob'ekt (Torus Knot - murakkabroq shakl soyalar yaxshi ko'rinishi uchun)
        const geometry = new THREE.TorusKnotGeometry(0.7, 0.2, 128, 32);
        const material = new THREE.MeshStandardMaterial({ 
            color: 0x3366ff, 
            roughness: 0.1, 
            metalness: 0.5 
        });
        const mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);

        // 4. Yorug'lik tizimi
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.2); // Umumiy yorug'lik
        scene.add(ambientLight);

        const pointLight = new THREE.PointLight(0xffffff, 10); // Nuqtaviy nur
        pointLight.position.set(2, 2, 2);
        scene.add(pointLight);

        // 5. Boshqaruv paneli (Tweakpane)
        const pane = new Pane();
        const params = {
            color: '#3366ff',
            intensity: 10,
            roughness: 0.1,
            metalness: 0.5,
            lightX: 2,
            lightY: 2
        };

        pane.addBinding(params, 'color').on('change', (ev) => material.color.set(ev.value));
        pane.addBinding(params, 'intensity', { min: 0, max: 50 });
        pane.addBinding(params, 'roughness', { min: 0, max: 1 });
        pane.addBinding(params, 'metalness', { min: 0, max: 1 });
        pane.addBinding(params, 'lightX', { min: -5, max: 5 });
        pane.addBinding(params, 'lightY', { min: -5, max: 5 });

        // 6. Animatsiya va Yangilanish
        function animate() {
            requestAnimationFrame(animate);

            // Avtomatik aylanish
            mesh.rotation.x += 0.005;
            mesh.rotation.y += 0.005;

            // Parametrlarni yangilash
            pointLight.intensity = params.intensity;
            pointLight.position.x = params.lightX;
            pointLight.position.y = params.lightY;
            material.roughness = params.roughness;
            material.metalness = params.metalness;

            renderer.render(scene, camera);
        }

        // Ekran o'zgarganda moslashish
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
